#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
#SingleInstance Force
; #Warn  ; Enable warnings to assist with detecting common errors.
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.

; MAKE SURE TO RENAME THE FILE TO HAVE .ahk at the end so the script is recognised as a AutoHotkey script.

; CapsLock sends text to first field in Anki
; Press Shift and CapsLock to use CapsLock regularly
; Press Windows key and 1 to send text to second field in Anki

+CapsLock::CapsLock
CapsLock::
WinWait, Add
WinMinimize, Add
WinGet, ID, ID, Add
Clipboard:=
send, ^c
ClipWait
SetKeyDelay, 0, 10
ControlSend , ,^1^v, ahk_id %ID%
WinRestore Add
Return

#1::
WinWait Add
WinMinimize Add
WinGet ID, ID, Add
Clipboard:=
send, ^c
ClipWait
SetKeyDelay, 0, 10
ControlSend , ,^2^v, ahk_id %ID%
WinRestore Add
Return
